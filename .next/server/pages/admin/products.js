"use strict";(()=>{var e={};e.id=209,e.ids=[209,888,660],e.modules={9353:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>h,getStaticPaths:()=>x,getStaticProps:()=>m,reportWebVitals:()=>b,routeModule:()=>P,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>v});var r=a(7093),l=a(5244),i=a(1323),n=a(9209),d=a.n(n),c=a(4495),o=a(6498),u=e([o]);o=(u.then?(await u)():u)[0];let p=(0,i.l)(o,"default"),m=(0,i.l)(o,"getStaticProps"),x=(0,i.l)(o,"getStaticPaths"),h=(0,i.l)(o,"getServerSideProps"),g=(0,i.l)(o,"config"),b=(0,i.l)(o,"reportWebVitals"),v=(0,i.l)(o,"unstable_getStaticProps"),f=(0,i.l)(o,"unstable_getStaticPaths"),S=(0,i.l)(o,"unstable_getStaticParams"),j=(0,i.l)(o,"unstable_getServerProps"),N=(0,i.l)(o,"unstable_getServerSideProps"),P=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/products",pathname:"/admin/products",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:o});s()}catch(e){s(e)}})},3:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>ProductForm});var r=a(997),l=a(6689),i=a(9648),n=e([i]);function ProductForm({product:e,onSaved:t}){let[a,s]=(0,l.useState)(e?.title||""),[n,d]=(0,l.useState)(e?.slug||""),[c,o]=(0,l.useState)(e?.price?e.price/100:0),[u,p]=(0,l.useState)(e?.images||[]),[m,x]=(0,l.useState)(e?.description||""),[h,g]=(0,l.useState)(e?.inStock??!0);async function upload(e){let t=new FormData;t.append("file",e);let a=await i.default.post("/api/admin/upload",t,{headers:{"Content-Type":"multipart/form-data"}});return a.data.url}async function handleFile(e){let t=await upload(e.target.files[0]);p(e=>[...e,t])}function removeImage(e){p(t=>t.filter(t=>t!==e))}async function handleSubmit(s){s.preventDefault();let r={title:a,slug:n,description:m,price:Math.round(100*Number(c)),images:u,inStock:h};e?await i.default.put(`/api/products/${e.id}`,r):await i.default.post("/api/products",r),t?.()}return(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[r.jsx("input",{value:a,onChange:e=>s(e.target.value),placeholder:"Title",className:"w-full p-2 border rounded"}),r.jsx("input",{value:n,onChange:e=>d(e.target.value),placeholder:"Slug",className:"w-full p-2 border rounded"}),r.jsx("input",{value:c,onChange:e=>o(e.target.value),placeholder:"Price (INR)",type:"number",className:"w-full p-2 border rounded"}),r.jsx("textarea",{value:m,onChange:e=>x(e.target.value),placeholder:"Description",className:"w-full p-2 border rounded"}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm mb-1",children:"Images"}),r.jsx("input",{type:"file",onChange:handleFile}),r.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:u.map((e,t)=>(0,r.jsxs)("div",{className:"relative",children:[r.jsx("img",{src:e,className:"w-20 h-20 object-cover rounded"}),r.jsx("button",{type:"button",onClick:()=>removeImage(e),className:"absolute -top-2 -right-2 bg-white rounded-full p-1 text-xs border",children:"\xd7"})]},t))})]}),r.jsx("div",{className:"flex items-center gap-3",children:(0,r.jsxs)("label",{className:"inline-flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:h,onChange:e=>g(e.target.checked)}),r.jsx("span",{children:"In stock"})]})}),r.jsx("button",{className:"px-4 py-2 bg-black text-white rounded",children:"Save"})]})}i=(n.then?(await n)():n)[0],s()}catch(e){s(e)}})},6498:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>AdminProducts,getServerSideProps:()=>getServerSideProps});var r=a(997),l=a(6689),i=a(3),n=a(9648),d=a(1649),c=e([i,n]);async function getServerSideProps(e){let t=await (0,d.getSession)(e);return t&&t.user?.role==="ADMIN"?{props:{}}:{redirect:{destination:"/api/auth/signin",permanent:!1}}}function AdminProducts(){let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(null);async function load(){let e=await n.default.get("/api/products");t(e.data)}return(0,l.useEffect)(()=>{load()},[]),(0,r.jsxs)("div",{className:"max-w-5xl mx-auto p-6",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Products"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"font-semibold mb-2",children:"Create / Edit"}),r.jsx(i.Z,{product:a,onSaved:()=>{s(null),load()}})]}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"font-semibold mb-2",children:"All products"}),r.jsx("div",{className:"space-y-3",children:e.map(e=>(0,r.jsxs)("div",{className:"border p-3 rounded flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("img",{src:e.images?.[0],className:"w-20 h-20 object-cover rounded"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold",children:e.title}),(0,r.jsxs)("div",{className:"text-sm",children:["â‚¹",(e.price/100).toFixed(2)]}),r.jsx("div",{className:"text-sm",children:e.inStock?"In stock":"Out of stock"})]})]}),(0,r.jsxs)("div",{className:"space-x-2",children:[r.jsx("button",{onClick:()=>s(e),className:"px-3 py-1 border rounded",children:"Edit"}),r.jsx("button",{onClick:async()=>{await n.default.delete(`/api/products/${e.id}`),load()},className:"px-3 py-1 border rounded",children:"Delete"})]})]},e.id))})]})]})]})}[i,n]=c.then?(await c)():c,s()}catch(e){s(e)}})},1649:e=>{e.exports=require("next-auth/react")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},1017:e=>{e.exports=require("path")},7310:e=>{e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[801,994,664,450,495],()=>__webpack_exec__(9353));module.exports=a})();