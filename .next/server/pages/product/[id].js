"use strict";(()=>{var e={};e.id=360,e.ids=[360,888,660],e.modules={9281:(e,t,r)=>{r.r(t),r.d(t,{config:()=>v,default:()=>x,getServerSideProps:()=>b,getStaticPaths:()=>h,getStaticProps:()=>g,reportWebVitals:()=>S,routeModule:()=>w,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>_,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>f});var s={};r.r(s),r.d(s,{default:()=>ProductPage,getServerSideProps:()=>getServerSideProps});var a=r(7093),i=r(5244),l=r(1323),o=r(9209),n=r.n(o),d=r(4495),c=r(997),u=r(1163),p=r(6689),m=r(1649);function ProductPage({product:e}){let t=(0,u.useRouter)(),{data:r}=(0,m.useSession)(),[s,a]=(0,p.useState)(!1),[i,l]=(0,p.useState)(1),[o,n]=(0,p.useState)(0);if(!e)return c.jsx("div",{children:"Not found"});async function handleBuy(){a(!0);try{let t=await fetch("/api/checkout/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{title:e.title,price:e.price,quantity:i}],successUrl:`${process.env.NEXT_PUBLIC_NEXTAUTH_URL||window.location.origin}/account/orders`,cancelUrl:`${process.env.NEXT_PUBLIC_NEXTAUTH_URL||window.location.origin}/product/${e.id}`,userId:r?.user?.id||null})}),s=await t.json();s.url?window.location=s.url:alert("Failed to create checkout session")}catch(e){console.error(e),alert("Checkout error")}finally{a(!1)}}function addToCart(){let t=new CustomEvent("add-to-cart",{detail:{id:e.id,title:e.title,price:e.price,images:e.images,quantity:i}});window.dispatchEvent(t),alert("Added to cart")}return(0,c.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[c.jsx("button",{onClick:()=>t.back(),className:"mb-4",children:"Back"}),(0,c.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[c.jsx("div",{className:"rounded overflow-hidden",children:c.jsx("img",{src:e.images[o],alt:e.title,className:"w-full h-96 object-cover rounded"})}),c.jsx("div",{className:"flex gap-2 mt-3",children:e.images.map((e,t)=>c.jsx("button",{onClick:()=>n(t),className:`w-20 h-20 rounded overflow-hidden border ${t===o?"ring-2 ring-emerald-500":""}`,children:c.jsx("img",{src:e,className:"w-full h-full object-cover"})},t))})]}),(0,c.jsxs)("div",{children:[c.jsx("h1",{className:"text-3xl font-bold",children:e.title}),c.jsx("p",{className:"mt-4 text-gray-700",children:e.description}),(0,c.jsxs)("p",{className:"mt-4 text-2xl font-semibold",children:["â‚¹",(e.price/100).toFixed(2)]}),(0,c.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[c.jsx("label",{className:"text-sm",children:"Qty"}),c.jsx("input",{type:"number",min:1,value:i,onChange:e=>l(Number(e.target.value)),className:"w-20 p-1 border rounded"})]}),(0,c.jsxs)("div",{className:"mt-6 flex gap-3",children:[c.jsx("button",{onClick:addToCart,className:"px-4 py-2 border rounded",children:"Add to cart"}),c.jsx("button",{onClick:handleBuy,disabled:s,className:"px-4 py-2 bg-emerald-700 text-white rounded",children:s?"Redirecting...":"Buy Now"})]})]})]})]})}async function getServerSideProps(e){let{id:t}=e.params,r=await fetch(`${process.env.NEXT_PUBLIC_NEXTAUTH_URL||"http://localhost:3000"}/api/products/${t}`);if(200!==r.status)return{props:{product:null}};let s=await r.json();return{props:{product:s}}}let x=(0,l.l)(s,"default"),g=(0,l.l)(s,"getStaticProps"),h=(0,l.l)(s,"getStaticPaths"),b=(0,l.l)(s,"getServerSideProps"),v=(0,l.l)(s,"config"),S=(0,l.l)(s,"reportWebVitals"),f=(0,l.l)(s,"unstable_getStaticProps"),P=(0,l.l)(s,"unstable_getStaticPaths"),_=(0,l.l)(s,"unstable_getStaticParams"),j=(0,l.l)(s,"unstable_getServerProps"),N=(0,l.l)(s,"unstable_getServerSideProps"),w=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/product/[id]",pathname:"/product/[id]",bundlePath:"",filename:""},components:{App:d.default,Document:n()},userland:s})},1649:e=>{e.exports=require("next-auth/react")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[801,994,664,450,163,495],()=>__webpack_exec__(9281));module.exports=r})();