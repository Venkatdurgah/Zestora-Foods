(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{5419:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/product/[id]",function(){return n(4929)}])},4929:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return d},default:function(){return ProductPage}});var i=n(5893),s=n(1163),a=n(7294),c=n(3299),r=n(3454),d=!0;function ProductPage(e){let{product:t}=e,n=(0,s.useRouter)(),{data:d}=(0,c.useSession)(),[l,o]=(0,a.useState)(!1),[u,m]=(0,a.useState)(1),[h,x]=(0,a.useState)(0);if(!t)return(0,i.jsx)("div",{children:"Not found"});async function handleBuy(){o(!0);try{var e;let n=await fetch("/api/checkout/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{title:t.title,price:t.price,quantity:u}],successUrl:"".concat(r.env.NEXT_PUBLIC_NEXTAUTH_URL||window.location.origin,"/account/orders"),cancelUrl:"".concat(r.env.NEXT_PUBLIC_NEXTAUTH_URL||window.location.origin,"/product/").concat(t.id),userId:(null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.id)||null})}),i=await n.json();i.url?window.location=i.url:alert("Failed to create checkout session")}catch(e){console.error(e),alert("Checkout error")}finally{o(!1)}}function addToCart(){let e=new CustomEvent("add-to-cart",{detail:{id:t.id,title:t.title,price:t.price,images:t.images,quantity:u}});window.dispatchEvent(e),alert("Added to cart")}return(0,i.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,i.jsx)("button",{onClick:()=>n.back(),className:"mb-4",children:"Back"}),(0,i.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"rounded overflow-hidden",children:(0,i.jsx)("img",{src:t.images[h],alt:t.title,className:"w-full h-96 object-cover rounded"})}),(0,i.jsx)("div",{className:"flex gap-2 mt-3",children:t.images.map((e,t)=>(0,i.jsx)("button",{onClick:()=>x(t),className:"w-20 h-20 rounded overflow-hidden border ".concat(t===h?"ring-2 ring-emerald-500":""),children:(0,i.jsx)("img",{src:e,className:"w-full h-full object-cover"})},t))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:t.title}),(0,i.jsx)("p",{className:"mt-4 text-gray-700",children:t.description}),(0,i.jsxs)("p",{className:"mt-4 text-2xl font-semibold",children:["â‚¹",(t.price/100).toFixed(2)]}),(0,i.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,i.jsx)("label",{className:"text-sm",children:"Qty"}),(0,i.jsx)("input",{type:"number",min:1,value:u,onChange:e=>m(Number(e.target.value)),className:"w-20 p-1 border rounded"})]}),(0,i.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,i.jsx)("button",{onClick:addToCart,className:"px-4 py-2 border rounded",children:"Add to cart"}),(0,i.jsx)("button",{onClick:handleBuy,disabled:l,className:"px-4 py-2 bg-emerald-700 text-white rounded",children:l?"Redirecting...":"Buy Now"})]})]})]})]})}},1163:function(e,t,n){e.exports=n(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5419)}),_N_E=e.O()}]);